Scan the current project for dependency vulnerabilities using the appropriate tool:

1. Detect project type by checking for manifest files:
   - package.json + bun.lock -> Use `bun audit`
   - package.json + package-lock.json -> Use `npm audit`
   - pyproject.toml, requirements.txt, or setup.py -> Use `pip-audit`
   - Any project -> Can use `trivy fs .` or `grype .` (universal scanners)

2. Check if the selected tool is installed, suggest installation if not

3. Run the scan with appropriate options:

## For JavaScript/Node.js projects (npm):
```bash
npm audit                          # Basic scan
npm audit --json                   # JSON output for CI
npm audit --audit-level=high       # Only high+ severity
npm audit --production             # Production deps only
npm audit fix                      # Auto-fix vulnerabilities
npm audit fix --dry-run            # Preview fixes
```

## For Bun projects:
```bash
bun audit                          # Basic scan
bun audit --json                   # JSON output
bun audit --audit-level=high       # High+ severity only
bun audit --prod                   # Production deps only
bun audit --ignore CVE-XXXX-XXXXX  # Ignore specific CVE
```

## For Python projects:
```bash
pip-audit                          # Scan current environment
pip-audit -r requirements.txt      # Scan requirements file
pip-audit --fix                    # Auto-fix vulnerabilities
pip-audit -f json                  # JSON output
pip-audit -f cyclonedx-json        # SBOM output
pip-audit --desc                   # Include descriptions
pip-audit -s osv                   # Use OSV database
uvx pip-audit                      # Run via uv (if uv is used)
```

## For universal scanning (any project):
```bash
# Trivy - scans OS packages, language deps, secrets, IaC
trivy fs .                         # Scan filesystem
trivy fs --scanners vuln .         # Vulnerabilities only
trivy fs --severity HIGH,CRITICAL .
trivy fs -f json -o results.json . # JSON output

# Grype - focused vulnerability scanner
grype .                            # Scan directory
grype . --only-fixed               # Show fixable vulns
grype . -o json                    # JSON output
grype . --fail-on high             # Exit 1 on high severity
```

4. Present results with severity levels and remediation advice

5. If vulnerabilities found, suggest:
   - Running fix commands where available (npm audit fix, pip-audit --fix)
   - Updating specific packages manually
   - Adding CI workflow to prevent future issues

Ask the user which tool they prefer if multiple are applicable.
