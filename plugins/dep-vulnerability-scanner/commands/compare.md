Compare dependency vulnerability scanning tools to help choose the right one:

Present this comparison table and help the user decide based on their needs:

## Tool Comparison Matrix

| Feature | Trivy | Grype | npm audit | bun audit | pip-audit |
|---------|-------|-------|-----------|-----------|-----------|
| **Ecosystems** | Multi (OS, containers, code) | Multi (containers, filesystems) | JavaScript/npm | JavaScript/Bun | Python |
| **Scan Speed** | Fast | Fast | Fast | Fast | Medium |
| **Auto-fix** | No | No | Yes | No | Yes |
| **SBOM Support** | Generate & scan | Scan only | No | No | Generate (CycloneDX) |
| **Offline Mode** | Yes (with cached DB) | Yes (with cached DB) | No | No | Limited |
| **CI Integration** | Excellent | Excellent | Good | Good | Good |
| **Output Formats** | JSON, SARIF, table, template | JSON, SARIF, CycloneDX | JSON, text | JSON, text | JSON, CycloneDX, Markdown |

## When to Use Each Tool

### Trivy - Best for:
- Container/Docker image scanning
- Kubernetes environments
- Multi-language monorepos
- Infrastructure-as-Code scanning
- Secret detection
- Compliance requirements (generates SBOMs)

### Grype - Best for:
- Focused vulnerability scanning
- SBOM-based security audits
- Container registries
- When you need EPSS/KEV risk scoring
- Lightweight alternative to Trivy

### npm audit - Best for:
- Pure Node.js/npm projects
- Quick checks during development
- Auto-fixing vulnerabilities
- Projects using package-lock.json

### bun audit - Best for:
- Bun.js projects
- Fast JavaScript dependency checks
- Projects using bun.lock

### pip-audit - Best for:
- Python projects
- Virtual environment auditing
- Integration with pip/pipx/uv workflows
- When you need CycloneDX SBOM output

## Recommendation Flow

1. **Single-language project?**
   - JavaScript/npm -> npm audit (built-in, has auto-fix)
   - Bun -> bun audit (built-in, fast)
   - Python -> pip-audit (or uvx pip-audit if using uv)

2. **Multi-language or container project?**
   - Use Trivy for comprehensive scanning
   - Add Grype for focused vulnerability checks

3. **CI/CD Pipeline?**
   - Trivy or Grype for comprehensive SARIF reports
   - Native tools (npm/bun/pip-audit) for language-specific jobs

4. **Need auto-remediation?**
   - npm audit fix for JavaScript
   - pip-audit --fix for Python
   - Others require manual updates

## Pros and Cons Summary

### Trivy
**Pros:** Most comprehensive, scans everything (vulns, secrets, IaC), excellent CI support
**Cons:** Larger download, more complex output, no auto-fix

### Grype
**Pros:** Fast, focused, good SBOM support, risk scoring with EPSS/KEV
**Cons:** No auto-fix, fewer scan types than Trivy

### npm audit
**Pros:** Built-in, auto-fix capability, GitHub Advisory Database
**Cons:** JavaScript only, requires network

### bun audit
**Pros:** Built-in to Bun, very fast, compatible with npm registry
**Cons:** JavaScript only, no auto-fix, newer tool

### pip-audit
**Pros:** Python-focused, auto-fix, multiple vuln databases (PyPI, OSV)
**Cons:** Slower for large projects, Python only

Ask the user about their project type and requirements, then recommend the best tool(s).
